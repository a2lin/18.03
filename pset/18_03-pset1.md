$$$\require{cancel}$$$
# 18.03
### Pset 1
[Problem Source](http://ocw.mit.edu/courses/mathematics/18-03-differential-equations-spring-2010/assignments/MIT18_03S10_ps1.pdf)

####Part I.

===
#####Section 0
===
######1A #5C
$$y' = \left( {y-1\over x+1}\right)^2$$
$${dy(x)\over dx} = {(y-1)^2\over (x+1)^2}$$
$$\int {1\over (x+1)^2}\;dx = \int {1\over (y(x)-1)^2}\;dy(x)$$
Solve left side:
$$\int {1\over (x+1)^2}\;dx$$
Make the substitution $$$u=(x+1)$$$ and therefore $$$du = dx$$$
$$\int u^{-2} du = -u^{-1}$$
$$-{1\over x+1}$$
Solve right side:
$$\int {1\over (y(x)-1)^2}\;dy(x)$$
Make the substitution $$$u = (y(x)-1)$$$ and therefore $$$du=dx$$$
$$\int u^{-2}\;du = -u^{-1}$$
$$-{1\over y(x)-1}$$
Substitute back in:
$$-{1\over x+1} +C = -{1\over y(x)-1}$$
$${1-C(x+1)\over x+1} = {1\over y(x)-1}$$
$${1 - C(x+1)} = {x+1\over y(x)-1}$$
$$(y(x)-1)\left(1-C(x+1)\right) = x+1 $$
$$y(x)-1 = {x+1\over 1-C(x+1)}$$
$$\bbox[5px, border:2px solid black] {y(x) = {x+1\over 1 - C(x+1)}+1}$$

######1.1 #32

$$\bbox[5px, border:2px solid black] {{dP(t)\over dt} = k\sqrt{P}} $$

######1.1 #33

$$\bbox[5px, border:2px solid black] {{dv(t)\over dt} = kv(t)^2}$$

######1.1 #35
$$\bbox[5px, border:2px solid black] {{dN(t)\over dt} = k(P-N(t))}$$

######1.4 #39

Let's model this problem as:
$${df(t)\over dt} = kf(t)$$
$$f(t) = Ce^{kt}$$ 
with k representing the decline parameter of the drug. We need to find out both C and k.
We know the following:
$$f(0) = {45mg\over 1kg} * 50kg = 2250\;mg$$
5 hours earlier, we had double the amount of drug:
$$f(5) = {2f(0)} = 2 * 2250 = 4500\;mg$$
So we can then solve for $$$C,k$$$ to get a general formula:
$$f(0) = 2250 = Ce^{k0}$$
$$C = 2250$$
$$f(5) = 4500 = 2250e^{k5}$$
$$2 = e^{5k}$$
$$k = {ln(2)\over 5}$$
So we have
$$f(t) = 2250e^{ln(2)t\over 5}$$
Finding f(1) is therefore:
$$f(1) = 2250e^{ln(2)*1\over 5}$$
$$f(1) = 2250e^{ln(2)\over 5}$$
So to anesthetize the dog for an hour, we should give an amount equal to:
$$f(1) = \bbox[5px, border:2px solid black] {2584.57\;mg}$$

######1.4 #66
Let's model the system as follows:
$$s(t) = rt + O$$ where $$$s(t)$$$ is the amount of snow per unit distance $$$d$$$ at time $$$t$$$, $$$r$$$ being the rate of snowfall. If we let $$$a$$$ be the amount of snow cleared by the snowplow per unit time $$$t$$$, and $$$x$$$ be the position of the snowplow at time $$$t$$$, we can observe the following equation:
$${dx\over dt} = {a \over rt + O}$$.
This equation states that the rate of movement per unit distance of the snowplow is the amount of snow it can move per unit time divided by how much snow needs to be moved per unit distance. See the following dimensional analysis:
$${distance \over time} = {{\text{cu-ft} \over time} \over {{\text{cu-ft} \over time} * time + \text{cu-ft} \over distance}}$$
$${distance \over time} = {distance * {\text{cu-ft} \over time} \over {\text{cu-ft} \over time} * time + \text{cu-ft}}$$
$${distance \over time} = {distance * {\text{cu-ft} \over time} \over \text{cu-ft} + \text{cu-ft}}$$
$${distance \over time} = {distance * \text{cu-ft} \over time * \text{cu-ft}}$$
$${distance \over time} = {distance \over time}$$

1. If we let t = 0 when the snow starts, $$$O$$$ becomes 0 (as there is no initial snow on the ground), and therefore we have $${dx \over dt} = {a\over rt}$$ If we let $$$k = {r \over a}$$$ we end up with the desired $$k{dx \over dt} = {1 \over t}$$
2.  Let's try to solve this differential equation. 
$$\int {1\over t} \;dt = \int k\; dx$$
$$kx(t) = ln(t) + C$$
$$x(t) = {ln(t) + C\over k}$$
$$x(t) = {ln(t)\over k} + C$$
at t = 1 we have:
$$x(1) = C$$
$$x(t\_{7a}) = {ln(t\_{7a})\over k} + x(1)$$
$$x(t\_{7a} + 1) = {ln(t\_{7a} + 1)\over k} + x(1)$$
$$x(t\_{7a} + 3) = {ln(t\_{7a} + 3)\over k} + x(1)$$
we know 
$$x(t\_{7a}+1)-x(t\_{7a}) = 2\qquad [1]$$
$$x(t\_{7a}+3)-x(t\_{7a}+1) = 2\qquad [2]$$
therefore, using the first equation [1]:
$${ln(t\_{7a}+1)\over k} - {ln(t\_{7a})\over k} = 2$$
$$ln(t\_{7a} + 1) - ln(t\_{7a}) = 2k$$
$$ln\left({t\_{7a}+1\over t\_{7a}}\right) = 2k$$
$${t\_{7a}+1\over t\_{7a}} = e^{2k}$$
$$t\_{7a}e^{2k} = t\_{7a}+1$$
$$t\_{7a} \left(e^{2k}-1\right) = 1$$
$$t\_{7a} = {1\over \left(e^{2k}-1\right)}\qquad [3]$$
Then using the second equation [2]:
$${ln(t\_{7a}+3) \over k} - {ln(t\_{7a}+1)\over k} = 2$$
$$ln(t\_{7a}+3) - ln(t\_{7a}+1) = 2k$$
$$ln\left({t\_{7a}+3\over t\_{7a}+1}\right) = 2k$$
$${t\_{7a}+3 \over t\_{7a}+1} = e^{2k}\qquad [4]$$
Substituting [3] into [4]:
$${{1\over e^{2k}-1} + 3 \over {1 \over e^{2k}-1} + 1} = e^{2k}$$
$${{1+3e^{2k}-3\over e^{2k}-1}\over {1+e^{2k}-1\over e^{2k}-1}} = e^{2k}$$
$${3e^{2k}-2\over e^{2k}} = e^{2k}$$
$$3e^{2k}-2 = e^{4k}$$
$$e^{4k}-3e^{2k}+2 = 0$$
$$(e^{2k}-2)(e^{2k}-1)$$
One of the roots is zero, and the other:
$$e^{2k}-2 = 0$$
$$e^{2k} = 2$$
$$2k = ln(2)$$
$$k = {ln(2)\over 2}$$
Since we know from before that:
$$t\_{7a} = {1\over \left(e^{2k}-1\right)}$$
We can plug in the result of k, and get:
$$t\_{7a} = {1\over \left( e^{2*ln(2)\over 2} -1 \right)}$$
$$t\_{7a} = 1$$
So therefore time "zero" was one hour ago.
$$\bbox[5px, border:2px solid black]{6\;am}$$

######1.5 #1
$${dy(x)\over dx} + y(x) = 2$$ 
We want to pick a $$$u(x)$$$ such that
$$u(x){dy(x)\over dx} + u(x)y(x) = 2u(x)$$
because we know that this can be represented as
$${d\over dx}\left(u(x)y(x)\right) = 2u(x)$$
if we pick $$$u(x)$$$ to be equal to $$${du(x)\over dx}$$$, we realize that $$$u(x)$$$ must equal $$$e^{x}$$$
$${d\over dx}e^{x}y(x) = 2e^{x}$$
$$\int{d\over dx}e^xy(x)dx = \int 2e^{x}dx$$
Using the First fundamental theorem of calculus to reduce the left integral, and solving the right integral yields:
$$e^{x}y(x) = 2e^{x} + C$$
dividing through by e^x gives:
$$y(x) = 2 + Ce^{-x}$$
The initial condition $$$y(0) = 0$$$ allows us to solve through:
$$y(0) = 2 + C$$
So $$$C = -2$$$.
$$\bbox[5px, border:2px solid black] {y(x) = 2 + -2e^{-x}}$$

######1.5 #9
$$xy'-y=x\qquad y(1) = 7$$
First step is to divide through by x.
$${dy(x)\over dx} - {1\over x}y(x) = 1$$
Then we try to pick $$$u(x)$$$ to make $$$u(x){-1\over x}={d\over dx}u(x)$$$
Solving this (simpler) differential equation by separation of variables yields:
$$\int {1\over u(x)} du = \int -{1\over x}dx$$
$$ln(u(x)) = -ln(x) + C$$
solving for $$$u(x)$$$ gives:
$$u(x) = C{1\over x}$$
We don't care about the C because any u(x) works for our use case, so we have:
$$u(x){dy(x)\over dx} - u(x){1\over x}y(x) = u(x)$$
We can check the earlier calculation of $$$u(x)$$$ here:
$${d\over dx}\left( {1\over x}y(x)\right) = {1\over x }{dy(x)\over dx} - {1\over x^2}y(x)$$
This seems to match with substituting $$$u(x)$$$
$${1\over x}{dy(x)\over dx} - {1\over x^2}y(x) = {1\over x}$$
$${d\over dx}\left({1\over x}y(x)\right) = {1\over x}$$
Solving this for y(x):
$$\int {d\over dx}\left({1\over x}y(x)\right) dx = \int {1\over x} dx$$
Again by the first fundamental theorem of calculus:
$${1\over x}y(x) = ln(x) + C$$
$$y(x) = xln(x) + Cx$$
we know that y(1) = 7, so
$$y(1) = 1\*ln(1) + 1\*C$$
$$C = 7$$
$$\bbox[5px, border:2px solid black] {y(x) = xln(x) + 7x}$$

######1.5 #20
$$y' = 1 + x + y + xy\qquad y(0) = 0$$
Rewrite this in standard form:
$${dy(x)\over dx} - y(1+x) = 1 + x$$
Find $$$u(x)$$$:
$$u(x){dy(x)\over dx} - u(x)y(x)(1+x) = u(x)(1+x)$$
$${d\over dx}\left( u(x) y(x)\right) = u(x)(1+x)$$
Find an appropriate $$$u(x)$$$:
$${du(x)\over dx} = -u(x)(1+x)$$
$$\int{-1\over u(x)}\;du(x) = \int (1+x)\;dx$$
$$-ln(u(x)) = x + {x^2\over 2} + C$$
$$u(x) = e^{-\left(x + {x^2\over 2}+C\right)}$$
Ignore the C as before (as any C is going to work), and substitute:
$${d\over dx}\left(e^{-\left(x + {x^2\over 2}\right)}y(x)\right) = e^{-\left(x + {x^2\over 2}\right)}(1+x)$$
$$\int {d\over dx}\left(e^{-\left(x + {x^2\over 2}\right)}y(x)\right)dx = \int e^{-\left(x + {x^2\over 2}\right)}(1+x)dx$$
Performing a $$$u$$$-substitution as follows:
$$u(x) = x + {x^2\over 2}$$
$${d\over dx}u(x) = (1 + x)$$
We can rewrite the RHS integral as:
$$\int e^{-u(x)}\;du$$
and therefore the result of this is:
$$-e^{-u(x)} + C$$
or
$$-e^{-\left(x + {x^2\over 2}\right)} + C$$
So substituting this back into the original equation and applying the first fundamental theorem of calculus on the LHS integral:
$$e^{-\left(x + {x^2\over 2}\right)}y(x) = -e^{-\left(x + {x^2\over 2}\right)} + C$$
$$y(x) = -1 + Ce^{x + {x^2\over 2}}$$
Using the initial value we were given:
$$y(0) = -1 + Ce^{0 + {0^2\over 2}}$$
$$C = 1$$
and therefore we can say:
$$\bbox[5px, border:2px solid black] {y(x) = -1 + e^{x + {x^2\over 2}}}$$

#####Section 1
===
######1C-1A
$$y' = -{y\over x}$$
$${dy(x)\over dx} = -{y\over x}$$
$$\int {1\over y}\;dy(x) = \int -{1\over x} \;dx$$
$$ln(y) = -ln(x) + C$$
$$\bbox[5px, border:2px solid black] {y = Ce^{-x}}$$
Plotting the direction field and the solution curve y(0)=1:
![image](1C1A.svg =500x500)

######1C-1B
$$y'=2x+y$$
$${dy(x)\over dx} = 2x + y$$
$${dy(x)\over dx} - y = 2x$$
This is an equation in standard form! It's possible to find a $$$u(x)$$$ such that:
$$u(x){dy(x)\over dx} - u(x)y(x) = u(x)2x$$
Pick $$$u(x)$$$ such that $$${du(x)\over dx} = -u(x)$$$:
$${du(x)\over dx} = -u(x)$$
$$\int {1\over u(x)}\;du(x) = \int -1\;dx$$
$$ln(u(x)) = -x + C$$
$$u(x) = Ce^{-x}$$ where C can be ignored as this is being used as a multiplying factor.
Substituting back in, we see:
$$e^{-x}{dy(x)\over dx}-e^{-x}y(x) = e^{-x}2x$$
or in its other form:
$${d\over dx}\left(e^{-x}y(x)\right) = e^{-x}2x$$
$$\int {d\over dx}\left(e^{-x}y(x)\right)\;dx = \int e^{-x}2x\;dx$$
Let's reduce the RHS:
$$\int e^{-x}2x\;dx$$
Let $$$u=2x$$$, $$$dv=e^{-x}$$$, $$$du = 2$$$, $$$v = -e^{-x}$$$.
Integrating by parts we see that since:
$$\int u{dv\over dx}\;dx = uv - \int v{du\over dx}\;dx$$
we can say that:
$$\int 2xe^{-x}\;dx = -2xe^{-x} - 2\int -e^{-x}\;dx$$
$$-2xe^{-x}+2\int e^{-x}\;dx$$
$$-2xe^{-x}-2e^{-x}$$
$$-2e^{-x}(x+1)$$
After using the first fundamental theorem of calculus on the LHS and substituting this expression in for the RHS:
$$e^{-x}y(x) = -2e^{-x}(x+1)+C$$
$$y(x) = -2(x+1)+{C\over e^{-x}}$$
Isocline means solve for some $$$C_1$$$ such that $$$C_1 = 2x + y$$$
So $$$y = C_1 - 2x$$$.

######1C-1C
$$y' = x - y$$
$${dy(x)\over dx} = x - y$$
$${dy(x)\over dx} + y = x $$
This is an equation in standard form!
$$u(x) * {dy(x)\over dx} + u(x) * y(x) = u(x) * x$$
We notice that this standard form, if $$$u(x)$$$ were equal to $$$du(x) \over dx$$$, would be equivalent to
$$$u(x) * {dy(x)\over {dx}} + y(x) * {du(x) \over dx}$$$, and this would correspond to: $${d \over dx} u(x) * y(x) $$

So solving for $$$u(x)$$$ = $$$du(x)\over dx$$$ we get $$$\int {1\over u(x)} du(x) = \int 1 dx $$$, which becomes $$$ln(u(x)) = x + C$$$, or $$$u(x) = Ce^x$$$. Since we are using $$$u(x)$$$ as a multiplying factor, we can drop the $$$C$$$ in this instance.

Multiplying u(x) in we see that we have
$$e^x * {dy(x)\over dx} + e^x * y(x) = e^x * x$$
This can be seen to be the derivative:
$${d\over dx} \left( e^x * y(x) \right)$$
Setting this equal to the RHS:
$${d\over dx} \left( e^x * y(x) \right) = e^x * x$$
Let's solve:
$$\int {d\over dx} \left( e^x * y(x) \right) dx = \int e^x * x \ dx $$
Solving the RHS:
$$\int e^x * x \ dx$$
Integrate by parts:
$$\int u\ dv = uv - \int v\ du$$
Let's pick $$$u = x$$$ and $$${dv(x)\over dx} = e^x$$$.

Then, $$${du(x)\over dx} = 1$$$ and $$$v = e^x$$$.

$$\int x * e^x\ dx = x * e^x - \int e^x\ dx $$
Plugging in the LHS from before:
$$e^x * y(x) = e^x * (x - 1) + C$$
$$\bbox[5px, border:2px solid black] {y(x) = (x - 1) + Ce^{-x}} $$

We can perform a quick check here:
$$y'(x) = 1 - C * e^{-x}$$
$$y'(x) = x - y(x) = x - (x - 1) - Ce^{-x}$$
$$y'(x) = 1 - C * e^{-x}$$
$$\bbox[5px, border:2px solid black] {1 - C * e^{-x} = 1 - C * e^{-x}} $$

######1C-1E
$$y' = {1 \over{x+y}}$$
![image](1C1E.svg =500x500)

#####Section 2
===
######1C-4
Using euler's method:
$$ x\_n = {x\_{n-1}} + h$$
$$ {y\_n} = {y\_{n-1}} + h * f(x\_0, y\_0) $$

For $$$y'=x+y^2$$$, and $$$y(0)=1$$$:

$$$h=0.1$$$

| n | $$$x_n$$$| $$$y_n$$$ | $$$f(x_n, y_n)$$$ | $$$hf(x_n, y_n)$$$ |
|---|----------|-----------|-------------------|------------------- |
|0|0|1|1|0.100|
|1|0.1|1.10|1.22|0.122|
|2|0.2|1.22|1.69|0.169|
|3|0.3|1.39|

To find out whether the estimate we have for $$$y(0.3)$$$ is low or high,
we can solve the equation analytically and check, or we can take the derivative
of $$$y'$$$ and check if concave/convex at 0.3.

Taking the derivative of $$${dy\over{dx}} = x + y^2 $$$, the result is $$$y'' = 1$$$, which indicates that the integral curve of y(x) is convex (due to a positive second-derivative). This leads to the conclusion that the approximate y(0.3) given by euler's method is going to underestimate the true value.

#####Section 3
===
######1.5 #33
Model this as follows:
$${dS(t)\over dt} = -{S(t)\over 1000} * 5$$
where:
$${dS(t)\over dt}\ =\text{ rate of salt change}$$ 
$$S(t) =\ \text{amount of salt at t}$$

We can check this model with dimensional analysis:
$${kg\over s} = {kg\over \cancel{L}} * {\cancel{L} \over s}$$

Given the initial condition $$$S(0)=100kg$$$, we can solve for the $$$t$$$ at which
$$$S(t)=10kg$$$. 

This differential equation is separable, and therefore we can write:
$$\int {1\over S(t)\ }dS(t) = \int -0.005\ dt$$
$$ln(S(t)) = -0.005t + C$$
$$S(t) = Ce^{-0.005t}$$

Using the initial condition $$$S(0)=100$$$ we can set the two forms of $$$S(0)$$$ equal to each other:
$$Ce^{-0.005 * 0} = 100$$
$$Ce^{0} = 100$$
$$C = 100$$

Therefore we have the specific solution:
$$S(t) = 100 * e^{-0.005t}$$

Solving for the t in which $$$S(t)=10$$$:
$$100 * e^{-0.005t} = 10$$
$$e^{-0.005t} = 0.1$$
$$-0.005t = ln(0.1)$$
$$t = {ln(0.1)\over -0.005}$$ 
$$\bbox[5px, border:2px solid black] {t \approx 460.517s}$$
$$\bbox[5px, border:2px solid black] {t \approx \text{7m 40.5s}}$$